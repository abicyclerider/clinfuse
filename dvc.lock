schema: '2.0'
stages:
  generate:
    cmd: rm -rf synthea_runner/output/synthea_raw && docker run --rm -e 
      JAVA_OPTS=-Xmx8g -v 
      $(pwd)/synthea_runner/output/synthea_raw:/synthea/synthea/output synthea 
      /bin/sh -c "./run_synthea -p 1001 -s 67890 
      --exporter.baseDirectory=./output --exporter.csv.export=true 
      --exporter.fhir.export=false Massachusetts"
    deps:
    - path: .build/synthea.iid
      hash: md5
      md5: fe512a6a7c94162316e3414a2615b512
      size: 72
    params:
      params.yaml:
        generate.population: 1001
        generate.seed: 67890
    outs:
    - path: synthea_runner/output/synthea_raw/csv
      hash: md5
      md5: da58114379f2d646eb3c12652973310e.dir
      size: 985071994
      nfiles: 18
  augment:
    cmd: rm -rf output/augmented && docker run --rm -v 
      $(pwd)/synthea_runner/output/synthea_raw/csv:/data/input:ro -v 
      $(pwd)/output/augmented:/data/output augmentation --input /data/input 
      --output /data/output --random-seed 99
    deps:
    - path: .build/augmentation.iid
      hash: md5
      md5: 3428ffd1db4b95bc51b7c195a7d3624a
      size: 72
    - path: synthea_runner/output/synthea_raw/csv
      hash: md5
      md5: 4ebf2c46b1fcca9429e01f41a8dad310.dir
      size: 487255591
      nfiles: 18
    params:
      params.yaml:
        augment.random_seed: 99
    outs:
    - path: output/augmented
      hash: md5
      md5: 179e2752db75c26aed1a057bc275d1e9.dir
      size: 69403659
      nfiles: 95
  resolve:
    cmd: rm -rf output/resolved && docker build -f entity_resolution/Dockerfile 
      -t entity_resolution . && docker run --rm -v 
      $(pwd)/output/augmented:/data/augmented:ro -v 
      $(pwd)/output/resolved:/data/resolved entity_resolution python -m 
      entity_resolution.resolve --augmented-dir /data/augmented --output-dir 
      /data/resolved --config entity_resolution/config/matching_config.yaml
    deps:
    - path: entity_resolution/Dockerfile
      hash: md5
      md5: 7cc32a34c0caf937ee0b223685f730ca
      size: 290
    - path: entity_resolution/config/matching_config.yaml
      hash: md5
      md5: da799d6ae2d5078d8b3e8ae7e6c46baf
      size: 1267
    - path: entity_resolution/core/
      hash: md5
      md5: f99a34d4be5e39101d68e7f801f96bd9.dir
      size: 77015
      nfiles: 12
    - path: entity_resolution/requirements-runtime.txt
      hash: md5
      md5: 7e2092f1ddb89d1289fbb7d876e18cdd
      size: 83
    - path: entity_resolution/resolve.py
      hash: md5
      md5: 69d119333698abbcce68b8062fd81659
      size: 10838
    - path: output/augmented
      hash: md5
      md5: e9bd16d0d640b671c463af92b9979985.dir
      size: 138063421
      nfiles: 96
    - path: shared/data_loader.py
      hash: md5
      md5: f53ed9b385eac459c4c29af6dd43b146
      size: 4707
    - path: shared/ground_truth.py
      hash: md5
      md5: 5d717ceb97e016ab796cf2fd0b3b5ba6
      size: 2846
    - path: shared/medical_records.py
      hash: md5
      md5: c3342b5e7a9782162d4a90229cb9c28e
      size: 4160
    - path: shared/summarize.py
      hash: md5
      md5: 8caae3e1a6f5ec4375327c7bd70f26b9
      size: 5040
    params:
      params.yaml:
        resolve.auto_match_probability: 0.99
        resolve.auto_reject_probability: 0.01
    outs:
    - path: output/resolved
      hash: md5
      md5: 0a19410d669bae17a23c06bad2af5c94.dir
      size: 3951770
      nfiles: 4
  golden_records:
    cmd: rm -rf output/golden_records && docker build -f 
      entity_resolution/Dockerfile -t entity_resolution . && docker run --rm -v 
      $(pwd)/output/augmented:/data/augmented:ro -v 
      $(pwd)/output/resolved:/data/resolved:ro -v 
      $(pwd)/output/inferred:/data/inferred:ro -v 
      $(pwd)/output/golden_records:/data/golden_records entity_resolution python
      -m entity_resolution.build_golden_records --augmented-dir /data/augmented 
      --auto-matches /data/resolved/auto_matches.parquet --predictions 
      /data/inferred/predictions.parquet --features 
      /data/resolved/features.parquet --output-dir /data/golden_records --config
      entity_resolution/config/matching_config.yaml
    deps:
    - path: entity_resolution/Dockerfile
      hash: md5
      md5: 7cc32a34c0caf937ee0b223685f730ca
      size: 290
    - path: entity_resolution/build_golden_records.py
      hash: md5
      md5: 92475ff57e3054c21588c10d8d3cb7a5
      size: 10796
    - path: entity_resolution/core/
      hash: md5
      md5: f99a34d4be5e39101d68e7f801f96bd9.dir
      size: 77015
      nfiles: 12
    - path: entity_resolution/requirements-runtime.txt
      hash: md5
      md5: 7e2092f1ddb89d1289fbb7d876e18cdd
      size: 83
    - path: output/augmented
      hash: md5
      md5: e9bd16d0d640b671c463af92b9979985.dir
      size: 138063421
      nfiles: 96
    - path: output/inferred/predictions.parquet
      hash: md5
      md5: e43a550e6846f93fe3fb6159ad457a5e
      size: 86689
    - path: output/resolved/auto_matches.parquet
      hash: md5
      md5: a4af59595ae7930aec053b172161da75
      size: 94130
    - path: output/resolved/features.parquet
      hash: md5
      md5: f93afb0d00e67d475e2424cbc4e8c09f
      size: 457396
    - path: shared/data_loader.py
      hash: md5
      md5: f53ed9b385eac459c4c29af6dd43b146
      size: 4707
    - path: shared/evaluation.py
      hash: md5
      md5: d8012a0682f532f4e144fa901014229c
      size: 1560
    - path: shared/ground_truth.py
      hash: md5
      md5: 5d717ceb97e016ab796cf2fd0b3b5ba6
      size: 2846
    outs:
    - path: output/golden_records
      hash: md5
      md5: e9471fced4f747e729d7146b7a1fef94.dir
      size: 230771
      nfiles: 3
  infer:
    cmd: mkdir -p output/inferred && llm_classifier/infer_remote.sh --gpu-type 
      "NVIDIA H100 80GB HBM3" --batch-size 64 
      output/resolved/gray_zone_pairs.parquet 
      output/inferred/predictions.parquet
    deps:
    - path: llm_classifier/Dockerfile
      hash: md5
      md5: 0c06814f3e97c1ee3261d3a245a41400
      size: 1494
    - path: llm_classifier/_remote_helpers.sh
      hash: md5
      md5: 1c4680c3739253868956368402cb78f0
      size: 5543
    - path: llm_classifier/infer_classifier.py
      hash: md5
      md5: 89dca8187b4ff7841a14d790496d9bb7
      size: 16971
    - path: llm_classifier/infer_remote.sh
      hash: md5
      md5: c3b302b2902cb3f8605d089160ea086d
      size: 7589
      isexec: true
    - path: llm_classifier/launch_pod.sh
      hash: md5
      md5: 0d45d0b88631a55c5ad1b154663749c4
      size: 4104
      isexec: true
    - path: llm_classifier/requirements.txt
      hash: md5
      md5: 4155a096ecc262e6a5963d396269ab6d
      size: 186
    - path: output/resolved/gray_zone_pairs.parquet
      hash: md5
      md5: 3fb97b3e4fca170ac2319a39ee1e572b
      size: 3399797
    outs:
    - path: output/inferred/predictions.parquet
      hash: md5
      md5: e43a550e6846f93fe3fb6159ad457a5e
      size: 86689
  train_scorer:
    cmd: rm -rf output/scorer && docker run --rm -v 
      $(pwd)/output/augmented:/data/augmented:ro -v 
      $(pwd)/output/resolved:/data/resolved:ro -v 
      $(pwd)/output/inferred:/data/inferred:ro -v 
      $(pwd)/output/scorer:/data/scorer entity-resolution python 
      entity-resolution/train_scorer.py --augmented-dir /data/augmented 
      --features /data/resolved/features.csv --predictions 
      /data/inferred/predictions.csv --output-dir /data/scorer
    deps:
    - path: entity-resolution/Dockerfile
      hash: md5
      md5: aa2df09e7babc2dd685536ad3ac410c4
      size: 270
    - path: entity-resolution/src/
      hash: md5
      md5: ac01e60838228d102b6b62db67e9be60.dir
      size: 89748
      nfiles: 13
    - path: entity-resolution/train_scorer.py
      hash: md5
      md5: 51b1464ba837f10602576d0167c80370
      size: 8326
    - path: output/augmented
      hash: md5
      md5: 4549fb5837ad07fe383e8bcb4948abd6.dir
      size: 533496994
      nfiles: 95
    - path: output/inferred/predictions.csv
      hash: md5
      md5: e54ab911add8ef1edf55ec7f5cf12402
      size: 6566366
    - path: output/resolved/features.csv
      hash: md5
      md5: f00eb320148f532263fc455c795a8a63
      size: 4802770
    - path: shared/
      hash: md5
      md5: dee2997ebbb4933304e9afa4bf0b7ce7.dir
      size: 30371
      nfiles: 10
    outs:
    - path: output/scorer
      hash: md5
      md5: ca86d9b96ae24ae89cb79ee5de47d04c.dir
      size: 3488
      nfiles: 2
  generate_training:
    cmd: rm -rf output/training/synthea_raw && docker run --rm -e 
      JAVA_OPTS=-Xmx8g -v 
      $(pwd)/output/training/synthea_raw:/synthea/synthea/output synthea /bin/sh
      -c "./run_synthea -p 30000 -s 12345 --exporter.baseDirectory=./output 
      --exporter.csv.export=true --exporter.fhir.export=false Massachusetts"
    deps:
    - path: .build/synthea.iid
      hash: md5
      md5: fe512a6a7c94162316e3414a2615b512
      size: 72
    params:
      params.yaml:
        generate_training.population: 30000
        generate_training.seed: 12345
    outs:
    - path: output/training/synthea_raw/csv
      hash: md5
      md5: 458ffb45caa8e2140f907dbe84c9ee5e.dir
      size: 29523079563
      nfiles: 18
  augment_training:
    cmd: rm -rf output/training/augmented && docker build -t augmentation -t 
      augmentation:$(git rev-parse --short HEAD) augmentation/ && docker run 
      --rm -v $(pwd)/output/training/synthea_raw/csv:/data/input:ro -v 
      $(pwd)/output/training/augmented:/data/output augmentation --input 
      /data/input --output /data/output --random-seed 42
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 15dd455982ee6b64f848ddb66fb2cee2
      size: 256
    - path: augmentation/cli/augment.py
      hash: md5
      md5: 8869463589fecb1cb4a409f417d10b0d
      size: 14099
    - path: augmentation/config/default_config.yaml
      hash: md5
      md5: db4ec3f2204d89251bb64462d00ecdad
      size: 1447
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: output/training/synthea_raw/csv
      hash: md5
      md5: b4ad442b5bec55659efc4cd41d9412a2.dir
      size: 446012269
      nfiles: 18
    params:
      params.yaml:
        augment_training.random_seed: 42
    outs:
    - path: output/training/augmented
      hash: md5
      md5: 73fd50125b4049894f0325b9545f6b9e.dir
      size: 64784914
      nfiles: 95
  prepare_dataset:
    cmd: rm -rf output/training/dataset && mkdir -p output/training/dataset && 
      docker run --rm -v $(pwd)/output/training/augmented:/data/augmented:ro -v 
      $(pwd)/output/training/dataset:/data/dataset -v 
      $(pwd)/llm_classifier/.env:/app/.env:ro prepare-dataset python 
      llm_classifier/prepare_dataset.py --augmented-dir /data/augmented 
      --output-dir /data/dataset --seed 42 --chunk-size 2000
    deps:
    - path: .build/prepare-dataset.iid
      hash: md5
      md5: c5ba4cba01d015bbef344cb8572a5241
      size: 72
    - path: llm_classifier/prepare_dataset.py
      hash: md5
      md5: e8be407d37dfc71e0b7d130d1024b74c
      size: 12840
    - path: output/training/augmented
      hash: md5
      md5: 0abae75fe52ae05585a67d1ebfa43c39.dir
      size: 4018136235
      nfiles: 96
    params:
      params.yaml:
        prepare_dataset.seed: 42
    outs:
    - path: output/training/dataset/dataset_info.json
      hash: md5
      md5: 222cee9249c9d96d0cbd0ffa01dcd388
      size: 235
  train:
    cmd: rm -rf output/training/train && mkdir -p output/training/train && 
      llm_classifier/train_remote.sh --gpu-type "NVIDIA H100 80GB HBM3" 
      output/training/train -- --epochs 3 --batch-size 4 --lr 0.0001 
      --max-length 2048 --lora-r 16 --max-samples 5000
    deps:
    - path: llm_classifier/Dockerfile
      hash: md5
      md5: 205eb5406996e295bca0625417c542a4
      size: 1372
    - path: llm_classifier/_remote_helpers.sh
      hash: md5
      md5: 94c2e7d4b9322c238878e87f23d1a01f
      size: 10532
    - path: llm_classifier/launch_pod.sh
      hash: md5
      md5: 0d45d0b88631a55c5ad1b154663749c4
      size: 4104
      isexec: true
    - path: llm_classifier/promote_model.py
      hash: md5
      md5: 234c20bbd5f36b9d3470d1730b23bd20
      size: 3124
    - path: llm_classifier/requirements.txt
      hash: md5
      md5: 4155a096ecc262e6a5963d396269ab6d
      size: 186
    - path: llm_classifier/train_classifier.py
      hash: md5
      md5: 550ff2548035b229b21d6511ed943ab2
      size: 11591
    - path: llm_classifier/train_remote.sh
      hash: md5
      md5: 99de1b07907b0a0b56ae0cdd3150f753
      size: 4894
      isexec: true
    - path: output/training/dataset/dataset_info.json
      hash: md5
      md5: 0f07a8bd343c67718a1cbeb40baabf6a
      size: 233
    params:
      params.yaml:
        train.batch_size: 4
        train.epochs: 3
        train.lora_r: 16
        train.lr: 0.0001
        train.max_length: 2048
        train.max_samples: 5000
    outs:
    - path: output/training/train/promotion_decision.json
      hash: md5
      md5: 8bf550d96832cdf191d860264111da03
      size: 145
    - path: output/training/train/train_metrics.json
      hash: md5
      md5: dbd93326078ce6a4a90f8074e7832412
      size: 346
  export:
    cmd: rm -rf output/training/export && mkdir -p output/training/export && 
      llm_classifier/export_remote.sh --gpu-type "NVIDIA H100 80GB HBM3" 
      output/training/export
    deps:
    - path: llm_classifier/Dockerfile
      hash: md5
      md5: 205eb5406996e295bca0625417c542a4
      size: 1372
    - path: llm_classifier/_remote_helpers.sh
      hash: md5
      md5: 94c2e7d4b9322c238878e87f23d1a01f
      size: 10532
    - path: llm_classifier/export_model.py
      hash: md5
      md5: b80f18b5d2d16715b5e5c16bce1f6104
      size: 10559
    - path: llm_classifier/export_remote.sh
      hash: md5
      md5: 73f163056a70c3319846f6a0848d5bd4
      size: 3565
      isexec: true
    - path: llm_classifier/launch_pod.sh
      hash: md5
      md5: 0d45d0b88631a55c5ad1b154663749c4
      size: 4104
      isexec: true
    - path: llm_classifier/requirements.txt
      hash: md5
      md5: 4155a096ecc262e6a5963d396269ab6d
      size: 186
    - path: output/training/train/promotion_decision.json
      hash: md5
      md5: 8bf550d96832cdf191d860264111da03
      size: 145
    - path: output/training/train/train_metrics.json
      hash: md5
      md5: dbd93326078ce6a4a90f8074e7832412
      size: 346
    outs:
    - path: output/training/export/export_info.json
      hash: md5
      md5: d931c8c481ea343296d61dfadb42ee07
      size: 283
  build_synthea:
    cmd: mkdir -p .build && docker build -t synthea -t synthea:$(git rev-parse 
      --short HEAD) synthea_runner/synthea-docker/ && docker image inspect 
      synthea --format '{{.Id}}' > .build/synthea.iid
    deps:
    - path: synthea_runner/synthea-docker/Dockerfile
      hash: md5
      md5: 1369d1d9cd02662b7bf3fe723a265ca1
      size: 1433
    outs:
    - path: .build/synthea.iid
      hash: md5
      md5: fe512a6a7c94162316e3414a2615b512
      size: 72
  build_augmentation:
    cmd: mkdir -p .build && docker build -t augmentation -t augmentation:$(git 
      rev-parse --short HEAD) augmentation/ && docker image inspect augmentation
      --format '{{.Id}}' > .build/augmentation.iid
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/csv_to_parquet.py
      hash: md5
      md5: cc3c82147ee0fd6c276c351f2b52365b
      size: 5390
    - path: augmentation/cli/inject_errors.py
      hash: md5
      md5: bae67cbfeb23ae6a8bf10736c82d8c9f
      size: 12173
    - path: augmentation/cli/segment.py
      hash: md5
      md5: 14455c96d77d8933499f80c738db7427
      size: 11919
    - path: augmentation/config/default_config.yaml
      hash: md5
      md5: db4ec3f2204d89251bb64462d00ecdad
      size: 1447
    - path: augmentation/core/streaming.py
      hash: md5
      md5: 09f8b13f86d74a812d1febcb73a3ca87
      size: 7212
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    outs:
    - path: .build/augmentation.iid
      hash: md5
      md5: e8f10fb8fdfda6eb085f546bf42a44d0
      size: 72
  build_prepare_dataset:
    cmd: mkdir -p .build && docker build -f llm_classifier/Dockerfile.prepare -t
      prepare-dataset -t prepare-dataset:$(git rev-parse --short HEAD) . && 
      docker image inspect prepare-dataset --format '{{.Id}}' > 
      .build/prepare-dataset.iid
    deps:
    - path: llm_classifier/Dockerfile.prepare
      hash: md5
      md5: 6242b2b0a3231d9cabb4c19f0ec8764e
      size: 264
    - path: llm_classifier/requirements-prepare.txt
      hash: md5
      md5: 70b89cb85a1deca8fa0f21758121638e
      size: 150
    - path: shared/data_loader.py
      hash: md5
      md5: f53ed9b385eac459c4c29af6dd43b146
      size: 4707
    - path: shared/ground_truth.py
      hash: md5
      md5: 5d717ceb97e016ab796cf2fd0b3b5ba6
      size: 2846
    - path: shared/medical_records.py
      hash: md5
      md5: c3342b5e7a9782162d4a90229cb9c28e
      size: 4160
    - path: shared/summarize.py
      hash: md5
      md5: 8caae3e1a6f5ec4375327c7bd70f26b9
      size: 5040
    outs:
    - path: .build/prepare-dataset.iid
      hash: md5
      md5: c5ba4cba01d015bbef344cb8572a5241
      size: 72
  build_entity_resolution:
    cmd: mkdir -p .build && docker build -f entity_resolution/Dockerfile -t 
      entity_resolution -t entity_resolution:$(git rev-parse --short HEAD) . && 
      docker image inspect entity_resolution --format '{{.Id}}' > 
      .build/entity_resolution.iid
    deps:
    - path: entity_resolution/Dockerfile
      hash: md5
      md5: 7cc32a34c0caf937ee0b223685f730ca
      size: 290
    - path: entity_resolution/core/
      hash: md5
      md5: 4590c9d42dc08d9d7886f341352aacd0.dir
      size: 83908
      nfiles: 12
    - path: entity_resolution/requirements-runtime.txt
      hash: md5
      md5: 7e2092f1ddb89d1289fbb7d876e18cdd
      size: 83
    - path: shared/
      hash: md5
      md5: ebf25359fb06b215c12fd12bd3dbdbb9.dir
      size: 164092
      nfiles: 31
    outs:
    - path: .build/entity_resolution.iid
      hash: md5
      md5: 11cf81a5ecd3328a17d20763f65b3758
      size: 72
  csv_to_parquet_training:
    cmd: rm -rf output/training/synthea_parquet && docker build -t augmentation 
      augmentation/ && docker run --rm --entrypoint python -v 
      $(pwd)/output/training/synthea_raw/csv:/data/input:ro -v 
      $(pwd)/output/training/synthea_parquet:/data/output augmentation -m 
      augmentation.cli.csv_to_parquet --input /data/input --output /data/output
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/csv_to_parquet.py
      hash: md5
      md5: cc3c82147ee0fd6c276c351f2b52365b
      size: 5390
    - path: augmentation/core/streaming.py
      hash: md5
      md5: 09f8b13f86d74a812d1febcb73a3ca87
      size: 7212
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: output/training/synthea_raw/csv
      hash: md5
      md5: 458ffb45caa8e2140f907dbe84c9ee5e.dir
      size: 29523079563
      nfiles: 18
    outs:
    - path: output/training/synthea_parquet
      hash: md5
      md5: b16040dfe23b8067bab8e94bd76647e1.dir
      size: 4180491807
      nfiles: 18
  segment_training:
    cmd: rm -rf output/training/segmented && docker build -t augmentation 
      augmentation/ && docker run --rm --entrypoint python -v 
      $(pwd)/output/training/synthea_parquet:/data/input:ro -v 
      $(pwd)/output/training/segmented:/data/output augmentation -m 
      augmentation.cli.segment --input /data/input --output /data/output 
      --assignment-seed 42 --confusable-pairs 500
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/segment.py
      hash: md5
      md5: 1767ecd32dbd503157c172473b5fabd8
      size: 13162
    - path: augmentation/core/confusable_groups.py
      hash: md5
      md5: d58e88093684351cf429b19215d51512
      size: 8194
    - path: augmentation/core/streaming.py
      hash: md5
      md5: 09f8b13f86d74a812d1febcb73a3ca87
      size: 7212
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: output/training/synthea_parquet
      hash: md5
      md5: b16040dfe23b8067bab8e94bd76647e1.dir
      size: 4180491807
      nfiles: 18
    params:
      params.yaml:
        augment_training.assignment_seed: 42
        augment_training.confusable_pairs: 500
    outs:
    - path: output/training/segmented
      hash: md5
      md5: f6bddc875d2c94fa54d28da1b3790fe4.dir
      size: 3988612682
      nfiles: 93
  inject_errors_training:
    cmd: rm -rf output/training/augmented && docker build -t augmentation 
      augmentation/ && docker run --rm --entrypoint python -v 
      $(pwd)/output/training/segmented:/data/input:ro -v 
      $(pwd)/output/training/augmented:/data/output augmentation -m 
      augmentation.cli.inject_errors --input /data/input --output /data/output 
      --error-seed 42
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/inject_errors.py
      hash: md5
      md5: 5585c982e82d5e47a7c423addf8ebdde
      size: 12424
    - path: augmentation/config/default_config.yaml
      hash: md5
      md5: f55db325a505483b4dee0ad46cd075c3
      size: 1641
    - path: augmentation/core/
      hash: md5
      md5: e5469dcdd4e88828a0b3f74b27addc3a.dir
      size: 102716
      nfiles: 15
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: output/training/segmented
      hash: md5
      md5: f6bddc875d2c94fa54d28da1b3790fe4.dir
      size: 3988612682
      nfiles: 93
    params:
      params.yaml:
        augment_training.error_seed: 42
    outs:
    - path: output/training/augmented
      hash: md5
      md5: 0abae75fe52ae05585a67d1ebfa43c39.dir
      size: 4018136235
      nfiles: 96
  csv_to_parquet:
    cmd: rm -rf synthea_runner/output/synthea_parquet && docker build -t 
      augmentation augmentation/ && docker run --rm --entrypoint python -v 
      $(pwd)/synthea_runner/output/synthea_raw/csv:/data/input:ro -v 
      $(pwd)/synthea_runner/output/synthea_parquet:/data/output augmentation -m 
      augmentation.cli.csv_to_parquet --input /data/input --output /data/output
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/csv_to_parquet.py
      hash: md5
      md5: cc3c82147ee0fd6c276c351f2b52365b
      size: 5390
    - path: augmentation/core/streaming.py
      hash: md5
      md5: 09f8b13f86d74a812d1febcb73a3ca87
      size: 7212
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: synthea_runner/output/synthea_raw/csv
      hash: md5
      md5: da58114379f2d646eb3c12652973310e.dir
      size: 985071994
      nfiles: 18
    outs:
    - path: synthea_runner/output/synthea_parquet
      hash: md5
      md5: 54a56526509011548e2e78aed862f1b9.dir
      size: 143385125
      nfiles: 18
  segment:
    cmd: rm -rf output/segmented && docker build -t augmentation augmentation/ 
      && docker run --rm --entrypoint python -v 
      $(pwd)/synthea_runner/output/synthea_parquet:/data/input:ro -v 
      $(pwd)/output/segmented:/data/output augmentation -m 
      augmentation.cli.segment --input /data/input --output /data/output 
      --assignment-seed 99 --confusable-pct 5.0
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/segment.py
      hash: md5
      md5: 3c34ab38d20c6051ac3070cd606cbfa0
      size: 13275
    - path: augmentation/core/confusable_groups.py
      hash: md5
      md5: d58e88093684351cf429b19215d51512
      size: 8194
    - path: augmentation/core/streaming.py
      hash: md5
      md5: 09f8b13f86d74a812d1febcb73a3ca87
      size: 7212
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: synthea_runner/output/synthea_parquet
      hash: md5
      md5: 54a56526509011548e2e78aed862f1b9.dir
      size: 143385125
      nfiles: 18
    params:
      params.yaml:
        augment.assignment_seed: 99
        augment.confusable_pct: 5.0
    outs:
    - path: output/segmented
      hash: md5
      md5: 5695a569faee36260f3dc9cdeed822d9.dir
      size: 136537590
      nfiles: 93
  inject_errors:
    cmd: rm -rf output/augmented && docker build -t augmentation augmentation/ 
      && docker run --rm --entrypoint python -v 
      $(pwd)/output/segmented:/data/input:ro -v 
      $(pwd)/output/augmented:/data/output augmentation -m 
      augmentation.cli.inject_errors --input /data/input --output /data/output 
      --error-seed 99 --min-errors 3 --max-errors 5 --error-weights 
      '{"name_variation":0.30,"address_error":0.20,"date_variation":0.15,"ssn_error":0.05,"formatting_error":0.00,"missing_data":0.30}'
    deps:
    - path: augmentation/Dockerfile
      hash: md5
      md5: 90ad339889d2602323bb98c771b5c9ee
      size: 222
    - path: augmentation/cli/inject_errors.py
      hash: md5
      md5: 8aec40e4c74723d60c0dc4a72093bd5c
      size: 13150
    - path: augmentation/config/default_config.yaml
      hash: md5
      md5: 4dd02a17bdf8912c9fb48456103d9b98
      size: 1743
    - path: augmentation/core/
      hash: md5
      md5: 66c73d7ac6be1e2d650de6f1c4191dd2.dir
      size: 103260
      nfiles: 15
    - path: augmentation/requirements-runtime.txt
      hash: md5
      md5: a84415c3be592d7ac92177a1b5e62dea
      size: 207
    - path: output/segmented
      hash: md5
      md5: 5695a569faee36260f3dc9cdeed822d9.dir
      size: 136537590
      nfiles: 93
    params:
      params.yaml:
        augment.error_seed: 99
        augment.error_weights: '{"name_variation":0.30,"address_error":0.20,"date_variation":0.15,"ssn_error":0.05,"formatting_error":0.00,"missing_data":0.30}'
        augment.max_errors: 5
        augment.min_errors: 3
    outs:
    - path: output/augmented
      hash: md5
      md5: e9bd16d0d640b671c463af92b9979985.dir
      size: 138063421
      nfiles: 96
